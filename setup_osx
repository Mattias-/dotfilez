#!/bin/bash

if ! xcode-select -p >/dev/null; then
    echo "Install Xcode command line tools and run script again"
    echo "xcode-select --install"
    exit 1
fi

if ! command -v brew >/dev/null; then
    ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

brew update
brew upgrade

brew bundle

#brew cask install google-drive
#brew cask install garmin-express
#brew cask install gpgtools
#brew install keybase # install after gpgtools

brew cleanup

ln -shf "$(brew --prefix)/opt/fzf" "$HOME/.fzf"
ln -s -f nvim "$(brew --prefix)/bin/vi"
ln -s -f nvim "$(brew --prefix)/bin/vim"

pip install --upgrade pip setuptools ipython flake8 py3kwarn

ln -shf "$HOME/Library/Mobile Documents/com~apple~CloudDocs" "$HOME/applecloud"
ln -shf "/Volumes/GoogleDrive/My Drive" "$HOME/gdrive"

git clone --recursive https://github.com/Mattias-/dotfilez.git "$HOME/dotfilez" || true
git submodule update --recursive --remote
python "$HOME/dotfilez/setup_dotfiles.py"

defaults write NSGlobalDomain KeyRepeat -int 1
defaults write NSGlobalDomain InitialKeyRepeat -int 12
